<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Calculate confidence interval for log determinant of covariance matrices — logdetCI â€¢ heplots</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>
  
  
<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">heplots</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Calculate confidence interval for log determinant of covariance matrices</h1>
    </div>

    
    <p>This function uses asymptotic results described by Cai et. al (2016),
Theorem 1,
to calculate approximate, normal theory confidence intervals (CIs) for
the log determinant of one or more sample covariance matrices.</p>
<p>Their results are translated into a CI via the approximation
$$ \log det( \widehat{\Sigma} ) - bias \pm z_{1 - \alpha/2} \times SE $$
where \( \widehat{\Sigma}\) is the sample estimate of a population
covariance matrix, 
\(bias\) is a bias correction constant and \(SE\) is a width factor for
the confidence interval.  Both \(bias\) and \(SE\) are functions of 
the sample size, \(n\) and number of variables, \(p\).</p>
<p>This function is included here only to provide an approximation to
<em>graphical accuracy</em> for use with Box's M test for equality of covariance
matrices, <code><a href='boxM.html'>boxM</a></code> and its associated <code><a href='plot.boxM.html'>plot.boxM</a></code> method.</p>
    

    <pre class="usage"><span class='fu'>logdetCI</span>(<span class='no'>cov</span>, <span class='no'>n</span>, <span class='kw'>conf</span> <span class='kw'>=</span> <span class='fl'>0.95</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>bias.adj</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>cov</th>
      <td><p>a covariance matrix or a (named) list of covariance matrices, all the same size</p></td>
    </tr>
    <tr>
      <th>n</th>
      <td><p>sample size, or vector of sample sizes, one for each covariance matrix</p></td>
    </tr>
    <tr>
      <th>conf</th>
      <td><p>confidence level</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>Three methods are provided, based on Cai et. al Theorem 1 (<code>method=1</code>), Colollary 1 (<code>method=2</code>) and 
Colollary 2 (<code>method=3</code>),
each with different bias and SE values.</p></td>
    </tr>
    <tr>
      <th>bias.adj</th>
      <td><p>logical; set <code>FALSE</code> to exclude the bias correction term.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    
    <p>Cai et. al (2015) claim that their Theorem 1 holds with either \(p\) fixed or \(p(n)\) growing with \(n\), as long as
\(p(n) \le n\). Their Corollary 1 (<code>method=2</code>) is the special case when \(p\) is fixed.
Their Corollary 2 (<code>method=3</code>) is the special case when \(0 \le p/n &lt; 1\) is fixed.</p>
<p>The properties of this CI estimator are unknown in small to moderate
sample sizes, but it seems to be the only one available. 
It is therefore experimental in this version of the package
and is subject to change in the future.</p>
<p>The \(bias\) term offsets the confidence interval from the sample
estimate of \( \log det( \widehat{\Sigma} ) \).
When \(p\) is large relative to \(n\), the confidence interval may not
overlap the sample estimate.</p>
<p>Strictly speaking, this estimator applies to the MLE of the covariance matrix \( \widehat{\Sigma}\), i.e.,
using \(n\) rather than \(n-1\) in as the divisor.  The factor \((n-1 / n)\)
has not yet been taken into account here.</p>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A data frame with one row for each covariance matrix.
<code>lower</code> and <code>upper</code> are the boundaries of the confidence intervals.
Other columns are <code>logdet, bias, se</code>.
<!-- %%  ~Describe the value returned -->
<!-- %%  If it is a LIST, use -->
<!-- %%  \item{comp1 }{Description of 'comp1'} -->
<!-- %%  \item{comp2 }{Description of 'comp2'} -->
<!-- %% ... --></p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    
    <p>Cai, T. T.; Liang, T. &amp; Zhou, H. H. (2015) Law of log determinant of sample covariance matrix and optimal estimation of differential entropy for high-dimensional Gaussian distributions Journal of Multivariate Analysis, 137, 161-172.
<a href='https://doi.org/10.1016/j.jmva.2015.02.003'>https://doi.org/10.1016/j.jmva.2015.02.003</a></p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <p><code><a href='boxM.html'>boxM</a></code>,
<code><a href='plot.boxM.html'>plot.boxM</a></code></p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'>data</span>(<span class='no'>iris</span>)
<span class='no'>iris.mod</span> <span class='kw'>&lt;-</span> <span class='fu'>lm</span>(<span class='fu'>as.matrix</span>(<span class='no'>iris</span>[,<span class='fl'>1</span>:<span class='fl'>4</span>]) ~ <span class='no'>iris</span>$<span class='no'>Species</span>)
<span class='no'>iris.boxm</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='boxM.html'>boxM</a></span>(<span class='no'>iris.mod</span>)
<span class='no'>cov</span> <span class='kw'>&lt;-</span> <span class='fu'>c</span>(<span class='no'>iris.boxm</span>$<span class='no'>cov</span>, <span class='fu'>list</span>(<span class='kw'>pooled</span><span class='kw'>=</span><span class='no'>iris.boxm</span>$<span class='no'>pooled</span>))
<span class='no'>n</span> <span class='kw'>&lt;-</span> <span class='fu'>c</span>(<span class='fu'>rep</span>(<span class='fl'>50</span>, <span class='fl'>3</span>), <span class='fl'>150</span>)

<span class='no'>CI</span> <span class='kw'>&lt;-</span> <span class='fu'>logdetCI</span>( <span class='no'>cov</span>, <span class='kw'>n</span><span class='kw'>=</span><span class='no'>n</span>, <span class='kw'>conf</span><span class='kw'>=</span><span class='fl'>.95</span>, <span class='kw'>method</span><span class='kw'>=</span><span class='fl'>1</span>)
<span class='no'>CI</span></div><div class='output co'>#&gt;                logdet        bias        se      lower      upper
#&gt; setosa     -13.067360 -0.20598584 0.4062465 -13.657603 -12.065146
#&gt; versicolor -10.874325 -0.20598584 0.4062465 -11.464568  -9.872111
#&gt; virginica   -8.927058 -0.20598584 0.4062465  -9.517301  -7.924844
#&gt; pooled      -9.958539 -0.06731274 0.2321101 -10.346154  -9.436299</div><div class='input'><span class='fu'>plot</span>(<span class='no'>iris.boxm</span>, <span class='kw'>xlim</span><span class='kw'>=</span><span class='fu'>c</span>(-<span class='fl'>14</span>, -<span class='fl'>8</span>), <span class='kw'>main</span><span class='kw'>=</span><span class='st'>"Iris data, Box's M test"</span>, <span class='kw'>gplabel</span><span class='kw'>=</span><span class='st'>"Species"</span>)</div><div class='input'><span class='fu'>arrows</span>(<span class='no'>CI</span>$<span class='no'>lower</span>, <span class='fl'>1</span>:<span class='fl'>4</span>, <span class='no'>CI</span>$<span class='no'>upper</span>, <span class='fl'>1</span>:<span class='fl'>4</span>, <span class='kw'>lwd</span><span class='kw'>=</span><span class='fl'>3</span>, <span class='kw'>angle</span><span class='kw'>=</span><span class='fl'>90</span>, <span class='kw'>len</span><span class='kw'>=</span><span class='fl'>.1</span>, <span class='kw'>code</span><span class='kw'>=</span><span class='fl'>3</span>)</div><div class='img'><img src='logdetCI-3.png' alt='' width='700' height='432.632880098887' /></div><div class='input'>
<span class='no'>CI</span> <span class='kw'>&lt;-</span> <span class='fu'>logdetCI</span>( <span class='no'>cov</span>, <span class='kw'>n</span><span class='kw'>=</span><span class='no'>n</span>, <span class='kw'>conf</span><span class='kw'>=</span><span class='fl'>.95</span>, <span class='kw'>method</span><span class='kw'>=</span><span class='fl'>1</span>, <span class='kw'>bias.adj</span><span class='kw'>=</span><span class='fl'>FALSE</span>)
<span class='no'>CI</span></div><div class='output co'>#&gt;                logdet bias        se      lower      upper
#&gt; setosa     -13.067360    0 0.4062465 -13.863589 -12.271132
#&gt; versicolor -10.874325    0 0.4062465 -11.670553 -10.078097
#&gt; virginica   -8.927058    0 0.4062465  -9.723287  -8.130830
#&gt; pooled      -9.958539    0 0.2321101 -10.413466  -9.503611</div><div class='input'><span class='fu'>plot</span>(<span class='no'>iris.boxm</span>, <span class='kw'>xlim</span><span class='kw'>=</span><span class='fu'>c</span>(-<span class='fl'>14</span>, -<span class='fl'>8</span>), <span class='kw'>main</span><span class='kw'>=</span><span class='st'>"Iris data, Box's M test"</span>, <span class='kw'>gplabel</span><span class='kw'>=</span><span class='st'>"Species"</span>)</div><div class='input'><span class='fu'>arrows</span>(<span class='no'>CI</span>$<span class='no'>lower</span>, <span class='fl'>1</span>:<span class='fl'>4</span>, <span class='no'>CI</span>$<span class='no'>upper</span>, <span class='fl'>1</span>:<span class='fl'>4</span>, <span class='kw'>lwd</span><span class='kw'>=</span><span class='fl'>3</span>, <span class='kw'>angle</span><span class='kw'>=</span><span class='fl'>90</span>, <span class='kw'>len</span><span class='kw'>=</span><span class='fl'>.1</span>, <span class='kw'>code</span><span class='kw'>=</span><span class='fl'>3</span>)</div><div class='img'><img src='logdetCI-4.png' alt='' width='700' height='432.632880098887' /></div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#details">Details</a></li>

      <li><a href="#value">Value</a></li>

      <li><a href="#references">References</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    
Michael Friendly

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by John Fox, Michael Friendly.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
