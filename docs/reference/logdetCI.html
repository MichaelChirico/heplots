<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Calculate confidence interval for log determinant of covariance matrices — logdetCI • heplots</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate confidence interval for log determinant of covariance matrices — logdetCI"><meta property="og:description" content="This function uses asymptotic results described by Cai et. al (2016),
Theorem 1,
to calculate approximate, normal theory confidence intervals (CIs) for
the log determinant of one or more sample covariance matrices.
Their results are translated into a CI via the approximation
$$ \log det( \widehat{\Sigma} ) - bias \pm z_{1 - \alpha/2} \times SE $$
where \( \widehat{\Sigma}\) is the sample estimate of a population
covariance matrix, 
\(bias\) is a bias correction constant and \(SE\) is a width factor for
the confidence interval.  Both \(bias\) and \(SE\) are functions ofS 
the sample size, \(n\) and number of variables, \(p\).
This function is included here only to provide an approximation to
graphical accuracy for use with Box's M test for equality of covariance
matrices, boxM and its associated plot.boxM method."><meta property="og:image" content="http://friendly.github.io/heplots/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">heplots</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.4-0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/friendly/heplots/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Calculate confidence interval for log determinant of covariance matrices</h1>
    
    <div class="hidden name"><code>logdetCI.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function uses asymptotic results described by Cai et. al (2016),
Theorem 1,
to calculate approximate, normal theory confidence intervals (CIs) for
the log determinant of one or more sample covariance matrices.</p>
<p>Their results are translated into a CI via the approximation
$$ \log det( \widehat{\Sigma} ) - bias \pm z_{1 - \alpha/2} \times SE $$
where \( \widehat{\Sigma}\) is the sample estimate of a population
covariance matrix, 
\(bias\) is a bias correction constant and \(SE\) is a width factor for
the confidence interval.  Both \(bias\) and \(SE\) are functions ofS 
the sample size, \(n\) and number of variables, \(p\).</p>
<p>This function is included here only to provide an approximation to
<em>graphical accuracy</em> for use with Box's M test for equality of covariance
matrices, <code><a href="boxM.html">boxM</a></code> and its associated <code><a href="plot.boxM.html">plot.boxM</a></code> method.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">logdetCI</span><span class="op">(</span><span class="va">cov</span>, <span class="va">n</span>, conf <span class="op">=</span> <span class="fl">0.95</span>, method <span class="op">=</span> <span class="fl">1</span>, bias.adj <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>cov</dt>
<dd><p>a covariance matrix or a (named) list of covariance matrices, all the same size</p></dd>

  <dt>n</dt>
<dd><p>sample size, or vector of sample sizes, one for each covariance matrix</p></dd>

  <dt>conf</dt>
<dd><p>confidence level</p></dd>


  <dt>method</dt>
<dd><p>Three methods are provided, based on Cai et. al Theorem 1 (<code>method=1</code>), Corollary 1 (<code>method=2</code>) and 
Corollary 2 (<code>method=3</code>),
each with different bias and SE values.</p></dd>

  <dt>bias.adj</dt>
<dd><p>logical; set <code>FALSE</code> to exclude the bias correction term.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    

<p>Cai et. al (2015) claim that their Theorem 1 holds with either \(p\) fixed or \(p(n)\) growing with \(n\), as long as
\(p(n) \le n\). Their Corollary 1 (<code>method=2</code>) is the special case when \(p\) is fixed.
Their Corollary 2 (<code>method=3</code>) is the special case when \(0 \le p/n &lt; 1\) is fixed.</p>
<p>The properties of this CI estimator are unknown in small to moderate
sample sizes, but it seems to be the only one available. 
It is therefore experimental in this version of the package
and is subject to change in the future.</p>
<p>The \(bias\) term offsets the confidence interval from the sample
estimate of \( \log det( \widehat{\Sigma} ) \).
When \(p\) is large relative to \(n\), the confidence interval may not
overlap the sample estimate.</p>
<p>Strictly speaking, this estimator applies to the MLE of the covariance matrix \( \widehat{\Sigma}\), i.e.,
using \(n\) rather than \(n-1\) in as the divisor.  The factor \((n-1 / n)\)
has not yet been taken into account here.</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    

<p>A data frame with one row for each covariance matrix.
<code>lower</code> and <code>upper</code> are the boundaries of the confidence intervals.
Other columns are <code>logdet, bias, se</code>.
<!-- %%  ~Describe the value returned --></p>


<p><!-- %%  If it is a LIST, use --></p>


<p><!-- %%  \item{comp1 }{Description of 'comp1'} --></p>


<p><!-- %%  \item{comp2 }{Description of 'comp2'} --></p>


<p><!-- %% ... --></p>


    </div>
    <div id="references">
    <h2>References</h2>
    

<p>Cai, T. T.; Liang, T. &amp; Zhou, H. H. (2015) Law of log determinant of sample covariance matrix and optimal estimation of differential entropy for high-dimensional Gaussian distributions. <em>Journal of Multivariate Analysis</em>, 137, 161-172.
doi: <a href="https://doi.org/10.1016/j.jmva.2015.02.003" class="external-link">10.1016/j.jmva.2015.02.003</a></p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Michael Friendly</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="boxM.html">boxM</a></code>,
<code><a href="plot.boxM.html">plot.boxM</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">iris.mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">iris</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span> <span class="op">~</span> <span class="va">iris</span><span class="op">$</span><span class="va">Species</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">iris.boxm</span> <span class="op">&lt;-</span> <span class="fu"><a href="boxM.html">boxM</a></span><span class="op">(</span><span class="va">iris.mod</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">cov</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">iris.boxm</span><span class="op">$</span><span class="va">cov</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>pooled<span class="op">=</span><span class="va">iris.boxm</span><span class="op">$</span><span class="va">pooled</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">3</span><span class="op">)</span>, <span class="fl">150</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">CI</span> <span class="op">&lt;-</span> <span class="fu">logdetCI</span><span class="op">(</span> <span class="va">cov</span>, n<span class="op">=</span><span class="va">n</span>, conf<span class="op">=</span><span class="fl">.95</span>, method<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">CI</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                logdet        bias        se      lower      upper</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> setosa     -13.067360 -0.20598584 0.4062465 -13.657603 -12.065146</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> versicolor -10.874325 -0.20598584 0.4062465 -11.464568  -9.872111</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> virginica   -8.927058 -0.20598584 0.4062465  -9.517301  -7.924844</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pooled      -9.958539 -0.06731274 0.2321101 -10.346154  -9.436299</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">iris.boxm</span>, xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">14</span>, <span class="op">-</span><span class="fl">8</span><span class="op">)</span>, main<span class="op">=</span><span class="st">"Iris data, Box's M test"</span>, gplabel<span class="op">=</span><span class="st">"Species"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/arrows.html" class="external-link">arrows</a></span><span class="op">(</span><span class="va">CI</span><span class="op">$</span><span class="va">lower</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, <span class="va">CI</span><span class="op">$</span><span class="va">upper</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, lwd<span class="op">=</span><span class="fl">3</span>, angle<span class="op">=</span><span class="fl">90</span>, len<span class="op">=</span><span class="fl">.1</span>, code<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="logdetCI-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">CI</span> <span class="op">&lt;-</span> <span class="fu">logdetCI</span><span class="op">(</span> <span class="va">cov</span>, n<span class="op">=</span><span class="va">n</span>, conf<span class="op">=</span><span class="fl">.95</span>, method<span class="op">=</span><span class="fl">1</span>, bias.adj<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">CI</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                logdet bias        se      lower      upper</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> setosa     -13.067360    0 0.4062465 -13.863589 -12.271132</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> versicolor -10.874325    0 0.4062465 -11.670553 -10.078097</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> virginica   -8.927058    0 0.4062465  -9.723287  -8.130830</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pooled      -9.958539    0 0.2321101 -10.413466  -9.503611</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">iris.boxm</span>, xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">14</span>, <span class="op">-</span><span class="fl">8</span><span class="op">)</span>, main<span class="op">=</span><span class="st">"Iris data, Box's M test"</span>, gplabel<span class="op">=</span><span class="st">"Species"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/arrows.html" class="external-link">arrows</a></span><span class="op">(</span><span class="va">CI</span><span class="op">$</span><span class="va">lower</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, <span class="va">CI</span><span class="op">$</span><span class="va">upper</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, lwd<span class="op">=</span><span class="fl">3</span>, angle<span class="op">=</span><span class="fl">90</span>, len<span class="op">=</span><span class="fl">.1</span>, code<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="logdetCI-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Michael Friendly, John Fox, Georges Monette.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer></div>

  


  

  </body></html>

